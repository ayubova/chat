(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,n){e.exports=n(296)},296:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(16),o=n.n(s),i=n(19),l=n(20),c=n(23),u=n(21),h=n(24),m=n(299),d=n(298),p=n(297),g=n(25),f=n(113),b=n.n(f),w=n(115),y=n.n(w),v=n(33),E=n.n(v),j=n(54),O=n.n(j),C=n(300),x=n(111),k=n(112),S=n.n(k),A=function(e){return S()(e).format("MMMM Do YYYY, h:mm:ss a")},N=function(e){return fetch("/publish",{method:"POST",body:e})},P=function(){return fetch("/messages").then(function(e){return e.json()}).then(function(e){return function(e){return e.map(function(e){return Object(x.a)({},e,{time:A(e.time)})}).reverse()}(e)})},M=function(e,t){return fetch("/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({login:e,password:t})}).then(function(e){return e.json()})},D=function(){return fetch("/logout")},L=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleLogout=function(){D(),n.props.history.push("/login")},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.location;return r.a.createElement("div",{className:t.root},r.a.createElement(b.a,{position:"static",color:"default"},r.a.createElement(y.a,null,r.a.createElement(E.a,{variant:"h6",color:"inherit",className:t.grow},"Chat"),"/"===n.pathname&&r.a.createElement(O.a,{className:t.loginButton,onClick:this.handleLogout},"Logout"))))}}]),t}(r.a.Component),T=Object(g.withStyles)({root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},loginButton:{backgroundColor:"#e0e0e0"}})(Object(C.a)(L)),I=n(120),F=n.n(I),K=n(74),U=n.n(K),W=n(27),B=n(59),Y=n.n(B),J=n(34),R=n.n(J),G=n(57),V=n.n(G),z=n(58),q=n.n(z),H=n(118),Q=n.n(H),X=n(119),Z=n.n(X),$=n(56),_=n.n($),ee=n(117),te=n.n(ee),ne=r.a.createContext("auth"),ae={login:"",password:"",showPassword:!1,error:!1},re=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state=ae,n.handleChange=function(e){return function(t){var a;return n.setState((a={},Object(W.a)(a,e,t.target.value),Object(W.a)(a,"error",!1),a))}},n.handleClickShowPassword=function(){return n.setState({showPassword:!n.state.showPassword})},n.handleKeyDown=function(e){if("Enter"===e.key){var t=n.state,a=t.error,r=t.login,s=t.password;!a&&r.length>0&&s.length>0&&n.handleLogin()}},n.handleLogin=function(){M(n.state.login,n.state.password).then(function(e){n.context.setUser(e),n.props.history.push("/")}).catch(function(){return n.setState({error:!0})})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.type!==this.props.type&&this.setState(ae)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.type;return r.a.createElement("form",{className:t.container,onKeyDown:this.handleKeyDown,noValidate:!0,autoComplete:"off"},r.a.createElement(_.a,{error:this.state.error,className:t.input},r.a.createElement(V.a,{htmlFor:"adornment-login"},"Login"),r.a.createElement(R.a,{id:"standard-multiline-flexible",label:"Login",value:this.state.login,onChange:this.handleChange("login"),fullWidth:!0})),r.a.createElement(_.a,{error:this.state.error,className:t.input},r.a.createElement(V.a,{htmlFor:"adornment-password"},"Password"),r.a.createElement(R.a,{id:"adornment-password",type:this.state.showPassword?"text":"password",value:this.state.password,fullWidth:!0,onChange:this.handleChange("password"),endAdornment:r.a.createElement(q.a,{position:"end"},r.a.createElement(Y.a,{"aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?r.a.createElement(Q.a,null):r.a.createElement(Z.a,null)))})),r.a.createElement(O.a,{variant:"outlined",fullWidth:!0,className:t.button,onClick:this.handleLogin},"signIn"===n?"Login":"Create account"))}}]),t}(r.a.Component);re.contextType=ne;var se=te()(Object(g.withStyles)(function(){return{input:{display:"block"},container:{width:"250px",margin:"auto"},button:{marginTop:"32px",backgroundColor:"#f5f5f5"}}}),C.a)(re),oe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={tabIndex:0},n.handleChange=function(e,t){return n.setState({tabIndex:t})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state.tabIndex;return r.a.createElement(a.Fragment,null,r.a.createElement("div",{position:"static",className:e.container},r.a.createElement(F.a,{value:this.state.tabIndex,onChange:this.handleChange,indicatorColor:"primary",variant:"fullWidth"},r.a.createElement(U.a,{className:e.tab,label:"Sign in"}),r.a.createElement(U.a,{className:e.tab,label:"Sign up"}))),0===t?r.a.createElement(se,{type:"signIn"}):r.a.createElement(se,{type:"signUp"}))}}]),t}(r.a.Component),ie=Object(g.withStyles)(function(){return{container:{width:"250px",margin:"auto",height:"48px",marginTop:"48px"},tab:{width:"125px",minWidth:"125px"}}})(oe),le=n(128),ce=n(127),ue=n.n(ce),he=n(121),me=n.n(he),de=n(73),pe=n.n(de),ge=n(123),fe=n.n(ge),be=n(126),we=n.n(be),ye=n(124),ve=n.n(ye),Ee=n(125),je=n.n(Ee),Oe=n(122),Ce=n.n(Oe),xe=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={newMessage:"",messages:[]},n.handleChange=function(e){return n.setState({newMessage:e.target.value})},n.handlePublish=function(){N(n.state.newMessage),n.setState({newMessage:""})},n.handleKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),n.state.newMessage.length>0&&n.handlePublish())},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;P().then(function(t){return e.setState({messages:t})});!function t(){fetch("/subscribe").then(function(e){return e.json()}).then(function(n){var a=n.message,r=n.user,s=n.time,o={message:a,user:r,time:A(s)};e.setState({messages:[o].concat(Object(le.a)(e.state.messages))}),t()}).catch(function(){return setTimeout(t,500)})}()}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(a.Fragment,null,r.a.createElement("form",{onKeyDown:this.handleKeyDown,className:e.container,noValidate:!0,autoComplete:"off"},r.a.createElement(me.a,{id:"standard-multiline-flexible",multiline:!0,rowsMax:"4",value:this.state.newMessage,onChange:this.handleChange,className:e.textField,margin:"normal",placeholder:"Write a message ...",variant:"outlined",InputProps:{endAdornment:r.a.createElement(q.a,{position:"end"},r.a.createElement(Y.a,{disabled:0===this.state.newMessage.length,onClick:this.handlePublish},r.a.createElement(Ce.a,null)))}})),r.a.createElement("div",{className:e.messages},r.a.createElement(pe.a,{className:e.root},this.state.messages.map(function(t,n){var s=t.message,o=t.user,i=t.time;return r.a.createElement(fe.a,{key:n,alignItems:"flex-start"},r.a.createElement(ve.a,null,r.a.createElement(je.a,null)),r.a.createElement(we.a,{secondary:r.a.createElement(a.Fragment,null,r.a.createElement(E.a,{component:"span",className:e.messageTitle,color:"textPrimary"},"".concat(o,", ").concat(i)),s)}))}))))}}]),t}(r.a.Component);xe.contextType=ne;var ke=Object(g.withStyles)(function(e){return{container:Object(W.a)({margin:"auto",display:"flex",alignItems:"baseline",width:600},e.breakpoints.only("xs"),{width:"100%"}),textField:Object(W.a)({marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:600},e.breakpoints.only("xs"),{width:"100%"}),button:{backgroundColor:"#e0e0e0",padding:4},messages:{margin:"auto",width:600,wordBreak:"break-word"},messageTitle:{display:"block",marginRight:16,fontSize:12}}})(ue()()(xe)),Se=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={isAuth:void 0,user:{}},n.setUser=function(e){return n.setState({user:e,isAuth:!0})},n.renderChat=function(){return n.state.isAuth?r.a.createElement(ke,null):r.a.createElement(m.a,{to:"/login"})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/user").then(function(e){return e.json()}).then(function(t){return e.setState({isAuth:!0,user:t})}).catch(function(){return e.setState({isAuth:!1})})}},{key:"render",value:function(){return r.a.createElement(d.a,null,void 0!==this.state.isAuth&&r.a.createElement(ne.Provider,{value:{isAuth:this.state.isAuth,user:this.state.user,setUser:this.setUser}},r.a.createElement(a.Fragment,null,r.a.createElement(T,null),r.a.createElement(p.a,{path:"/",exact:!0,render:this.renderChat}),r.a.createElement(p.a,{path:"/login",component:ie}))))}}]),t}(a.Component);o.a.render(r.a.createElement(Se,null),document.getElementById("root"))}},[[129,2,1]]]);
//# sourceMappingURL=main.4d488c89.chunk.js.map